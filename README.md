📌 Overview

What is CHARMTwinsight?
CHARMTwinsight is a medical digital twin framework within Project CHARM, designed to simulate patient trajectories using real and synthetic healthcare data.

The repository is built to:
✅ Ingest real FHIR data from HAPI-FHIR.
✅ Process synthetic patient data generated by Synthea.
✅ Support future predictive analytics for clinical decision-making.

This milestone focuses on the ingestion pipeline and does not yet finalize the storage layer.

📌 What is FHIR?

FHIR (Fast Healthcare Interoperability Resources) is a standard developed by HL7 for healthcare data exchange in modern digital systems. It defines a common data model and API for interoperability between electronic health record (EHR) systems.

📖 Learn More: HL7 FHIR Official Documentation (https://www.hl7.org/fhir/)

📌 What is HAPI-FHIR?

HAPI-FHIR is an open-source FHIR server that allows storing, querying, and managing FHIR-compliant patient data.

📖 Learn More: HAPI-FHIR GitHub (https://github.com/hapifhir/hapi-fhir)

🖥 This repository uses HAPI-FHIR to:
✅ Store both real and synthetic patient data.
✅ Serve FHIR-compliant patient records via API requests.
✅ Provide a backend repository for digital twin analytics.

📌 What is Synthea?

Synthea (Synthetic Patient Generator) is an open-source tool that creates realistic, FHIR-compliant synthetic patient records for research and testing.

📖 Learn More: Synthea GitHub (https://github.com/synthetichealth/synthea)

🖥 This repository uses Synthea to:
✅ Generate US Core-compliant synthetic patient records.
✅ Simulate population health data for research.
✅ Test CHARMTwinsight ingestion workflows.

📌 Repository Architecture

📍 Goal: Establish a minimal data repository that can:

Ingest data from HAPI-FHIR (FHIR-HOSE).
Support synthetic data generation via Synthea.
Store basic demographics & lab values for future analytics.
Remain flexible for additional data types (e.g., time-series).
📍 Key Components:
1️⃣ HAPI-FHIR Server: Stores real & synthetic patient data.
2️⃣ Synthea Generator: Creates synthetic patient data.
3️⃣ Python Upload Script: Pushes FHIR JSON files to HAPI-FHIR.
4️⃣ Data Ingestion Pipeline: API to receive patient data for analytics.

📌 Current Limitation: The final storage choice (SQL/NoSQL/cloud) is still under evaluation.

📌 How to Set Up & Run the Project

🚀 Prerequisites
📌 You need to install:
✅ Java (for running Synthea).
✅ Docker (for running HAPI-FHIR).
✅ Python 3 (for executing the upload script).

1️⃣ Start a Local HAPI-FHIR Server
📍 Option 1: Run HAPI-FHIR with Docker

docker pull hapiproject/hapi:latest
docker run -p 8080:8080 hapiproject/hapi:latest

After starting the server, visit:

FHIR API: http://localhost:8080/fhir

2️⃣ Generate Synthetic Patients with Synthea
📍 Download the Synthea JAR file:
📖 Synthea GitHub Releases
OR
Add the .jar file to this repo under synthea/.

📍 Run Synthea to generate synthetic patients:

java -jar synthea-with-dependencies.jar -p 20 -a 1-90 -s 123 --exporter.fhir.use_us_core_ig true
🔹 This generates 20 synthetic patients, aged 1-90, in FHIR US Core format.
🔹 JSON files will be in: /output/fhir/patients/.

3️⃣ Upload Data to HAPI-FHIR
📍 Run the Python script to upload patients:

python upload_patients.py
🖥 What This Script Does:
✅ Reads patient JSON files from /output/fhir/patients/.
✅ Uploads them to HAPI-FHIR (http://localhost:8080/fhir).
✅ Prints success/error messages for debugging.

📌 Code Structure

/synthea/                     # (Optional) Synthea JAR file  
/output/fhir/patients/        # FHIR patient JSON files  
/upload_patients.py           # Python script to upload patients  
/README.md                    # Documentation  
📌 Example API Calls

✅ Check if Patients Were Uploaded

curl -X GET "http://localhost:8080/fhir/Patient?_count=5" -H "Accept: application/json"
✅ Check the FHIR Server Capability Statement

curl -X GET "http://localhost:8080/fhir/metadata" -H "Accept: application/json"

📌 Next Steps & Extensions

🔹 Upcoming Features:
✅ Automate bulk uploads (batch processing).
✅ Support real patient ingestion from external FHIR-HOSE pipelines.
✅ Enhance storage layer for analytics & machine learning.

📌 Conclusion

🔥 This repository is the foundation of CHARMTwinsight’s data ingestion pipeline.
✅ It enables synthetic & real patient data ingestion.
✅ Uses HAPI-FHIR as a backend repository.
✅ Supports future predictive analytics and digital twin modeling.